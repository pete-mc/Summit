<body>
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript">
        document.addEventListener('deviceready', function() {
            var ref = cordova.InAppBrowser.open('https://terrain.scouts.com.au', '_blank', 'location=yes');
            console.log("deviceready");
            ref.addEventListener('loadstop', function(event) {
                console.log("loadstop");
                var url = new URL(event.url);
                if (url.origin === 'https://terrain.scouts.com.au' && url.pathname !== '/') {
                    // JavaScript files to inject
                    var jsFiles = [
                        "/bin/summit.js"
                    ];

                    // CSS files to inject
                    var cssFiles = [
                        "/styles/dependencies/datatables.min.css",
                        "/styles/dependencies/flatpickr.min.css",
                        "/styles/summit.css"
                    ];

                    jsFiles.forEach(function(jsFile) {
                        fetch(jsFile)
                            .then(response => response.text())
                            .then(js => {
                                ref.executeScript({ code: js });
                            })
                            .catch(error => console.log('Error injecting JS file:', error));
                    });

                    cssFiles.forEach(function(cssFile) {
                        fetch(cssFile)
                            .then(response => response.text())
                            .then(css => {
                                ref.insertCSS({ code: css });
                            })
                            .catch(error => console.log('Error injecting CSS file:', error));
                    });
                }
            });

            ref.addEventListener('loaderror', function(event) {
                console.log('Load error: ' + event.message);
            });
        });
    </script>
</body>